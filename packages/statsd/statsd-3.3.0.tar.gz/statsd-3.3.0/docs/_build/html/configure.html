
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Configuring Statsd &#8212; Python StatsD 3.3.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data Types" href="types.html" />
    <link rel="prev" title="Welcome to Python StatsD’s documentation!" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="types.html" title="Data Types"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Python StatsD’s documentation!"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Python StatsD 3.3.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="configuring-statsd">
<span id="configuring-chapter"></span><h1>Configuring Statsd<a class="headerlink" href="#configuring-statsd" title="Permalink to this headline">¶</a></h1>
<p>It’s easy to configure and use Statsd at runtime, but there are also two
shortcuts available.</p>
<div class="section" id="runtime">
<h2>Runtime<a class="headerlink" href="#runtime" title="Permalink to this headline">¶</a></h2>
<p>If you are running the <a class="reference external" href="https://github.com/etsy/statsd">statsd</a> server locally and on the default port,
it’s extremely easy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsd</span> <span class="kn">import</span> <span class="n">StatsClient</span>

<span class="n">statsd</span> <span class="o">=</span> <span class="n">StatsClient</span><span class="p">()</span>
<span class="n">statsd</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>There are several arguments to configure your <a class="reference internal" href="reference.html#StatsClient" title="StatsClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">StatsClient</span></code></a> instance.
They, and their defaults, are:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsd</span> <span class="kn">import</span> <span class="n">StatsClient</span>

<span class="n">statsd</span> <span class="o">=</span> <span class="n">StatsClient</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
                     <span class="n">port</span><span class="o">=</span><span class="mi">8125</span><span class="p">,</span>
                     <span class="n">prefix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">maxudpsize</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
                     <span class="n">ipv6</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">host</span></code> is the host running the statsd server. It will support any kind of
name or IP address you might use.</p>
<p><code class="docutils literal notranslate"><span class="pre">port</span></code> is the statsd server port. The default for both server and client is
<code class="docutils literal notranslate"><span class="pre">8125</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">prefix</span></code> helps distinguish multiple applications or environments using the
same statsd server. It will be prepended to all stats, automatically. For
example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsd</span> <span class="kn">import</span> <span class="n">StatsClient</span>

<span class="n">foo_stats</span> <span class="o">=</span> <span class="n">StatsClient</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="n">bar_stats</span> <span class="o">=</span> <span class="n">StatsClient</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>

<span class="n">foo_stats</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s1">&#39;baz&#39;</span><span class="p">)</span>
<span class="n">bar_stats</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s1">&#39;baz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>will produce two different stats, <code class="docutils literal notranslate"><span class="pre">foo.baz</span></code> and <code class="docutils literal notranslate"><span class="pre">bar.baz</span></code>. Without the
<code class="docutils literal notranslate"><span class="pre">prefix</span></code> argument, or with the same <code class="docutils literal notranslate"><span class="pre">prefix</span></code>, two <code class="docutils literal notranslate"><span class="pre">StatsClient</span></code> instances
will update the same stats.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.0.3.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">maxudpsize</span></code> specifies the maximum packet size statsd will use. This is an
advanced options and should not be changed unless you know what you are doing.
Larger values then the default of 512 are generally deemed unsafe for use on
the internet. On a controlled local network or when the statsd server is
running on 127.0.0.1 larger values can decrease the number of UDP packets when
pipelining many metrics. Use with care!</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ipv6</span></code> tells the client explicitly to look up the host using IPv6 (<code class="docutils literal notranslate"><span class="pre">True</span></code>)
or IPv4 (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Python will will inherently bind to an ephemeral port on all interfaces
(<cite>0.0.0.0</cite>) for each configured client. This is due to the underlying
Sockets API in the operating system/kernel. It is safe to block incoming
traffic on your firewall if you wish.</p>
</div>
<div class="section" id="tcp-clients">
<h3>TCP Clients<a class="headerlink" href="#tcp-clients" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="tcp.html#tcp-chapter"><span class="std std-ref">TCP-based clients</span></a> have an additional <code class="docutils literal notranslate"><span class="pre">timeout</span></code> argument,
which defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>, and is passed to <a class="reference external" href="https://docs.python.org/2/library/socket.html#socket.socket.settimeout">settimeout</a>.</p>
</div>
<div class="section" id="unixsocket-clients">
<h3>UnixSocket Clients<a class="headerlink" href="#unixsocket-clients" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="unix_socket.html#unix-socket-chapter"><span class="std std-ref">UnixSocket-based clients</span></a> have a single required
<code class="docutils literal notranslate"><span class="pre">socket_path</span></code> argument instead of <code class="docutils literal notranslate"><span class="pre">host</span></code> and <code class="docutils literal notranslate"><span class="pre">port</span></code>.</p>
</div>
</div>
<div class="section" id="in-django">
<h2>In Django<a class="headerlink" href="#in-django" title="Permalink to this headline">¶</a></h2>
<p>If you are using Statsd in a <a class="reference external" href="https://www.djangoproject.com/">Django</a> application, you can configure a default
<a class="reference internal" href="reference.html#StatsClient" title="StatsClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">StatsClient</span></code></a> in the Django settings. All of these settings are
optional.</p>
<p>Here are the settings and their defaults:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">STATSD_HOST</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span>
<span class="n">STATSD_PORT</span> <span class="o">=</span> <span class="mi">8125</span>
<span class="n">STATSD_PREFIX</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">STATSD_MAXUDPSIZE</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">STATSD_IPV6</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
<p>You can use the default <a class="reference internal" href="reference.html#StatsClient" title="StatsClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">StatsClient</span></code></a> simply:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsd.defaults.django</span> <span class="kn">import</span> <span class="n">statsd</span>

<span class="n">statsd</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="from-the-environment">
<h2>From the Environment<a class="headerlink" href="#from-the-environment" title="Permalink to this headline">¶</a></h2>
<p>StatsD isn’t only useful in Django or on the web. A default instance can also
be configured via environment variables.</p>
<p>Here are the environment variables and their defaults:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">STATSD_HOST</span><span class="o">=</span>localhost
<span class="nv">STATSD_PORT</span><span class="o">=</span><span class="m">8125</span>
<span class="nv">STATSD_PREFIX</span><span class="o">=</span>None
<span class="nv">STATSD_MAXUDPSIZE</span><span class="o">=</span><span class="m">512</span>
<span class="nv">STATSD_IPV6</span><span class="o">=</span><span class="m">0</span>
</pre></div>
</div>
<p>and then in your Python application, you can simply do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsd.defaults.env</span> <span class="kn">import</span> <span class="n">statsd</span>

<span class="n">statsd</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As of version 3.0, this default instance is always available, configured
with the default values, unless overridden by the environment.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Configuring Statsd</a><ul>
<li><a class="reference internal" href="#runtime">Runtime</a><ul>
<li><a class="reference internal" href="#tcp-clients">TCP Clients</a></li>
<li><a class="reference internal" href="#unixsocket-clients">UnixSocket Clients</a></li>
</ul>
</li>
<li><a class="reference internal" href="#in-django">In Django</a></li>
<li><a class="reference internal" href="#from-the-environment">From the Environment</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to Python StatsD’s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="types.html"
                        title="next chapter">Data Types</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/configure.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="types.html" title="Data Types"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Python StatsD’s documentation!"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Python StatsD 3.3.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, James Socol.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.7.
    </div>
  </body>
</html>