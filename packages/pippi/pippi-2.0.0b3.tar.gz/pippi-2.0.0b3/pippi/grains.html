<!DOCTYPE html>
<!-- Generated by Cython 0.28.4 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: grains.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.28.4</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="grains.c">grains.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: # cython: language_level=3</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: from .soundbuffer cimport SoundBuffer, _cut, _dub, _speed, _pan, _env</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: from . cimport wavetables</pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: from . cimport interpolation</pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: from libc.stdlib cimport rand, RAND_MAX</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">007</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">008</span>: from cpython cimport array</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">009</span>: import array</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_array, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_array, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">010</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: DEF MIN_DENSITY = 0.000001</pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: DEF MIN_SPEED = 0.000001</pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: DEF MIN_GRAIN_FRAMELENGTH = 441</pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>: DEF DEFAULT_WTSIZE = 4096</pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>: DEF DEFAULT_GRAINLENGTH = 60</pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: DEF DEFAULT_MAXGRAINLENGTH = 80</pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: DEF DEFAULT_SPEED = 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>: DEF DEFAULT_MAXSPEED = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>: DEF DEFAULT_DENSITY = 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: DEF DEFAULT_MINDENSITY = 0.5</pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: DEF DEFAULT_MAXDENSITY = 1.5</pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">023</span>: cdef double[:,:] _play(GrainCloud cloud, double[:,:] out, int framelength, double length):</pre>
<pre class='cython code score-11 '>static __Pyx_memviewslice __pyx_f_5pippi_6grains__play(struct __pyx_obj_5pippi_6grains_GrainCloud *__pyx_v_cloud, __Pyx_memviewslice __pyx_v_out, int __pyx_v_framelength, CYTHON_UNUSED double __pyx_v_length) {
  int __pyx_v_input_length;
  int __pyx_v_fi;
  int __pyx_v_ci;
  int __pyx_v_write_pos;
  int __pyx_v_write_inc;
  int __pyx_v_start;
  CYTHON_UNUSED int __pyx_v_end;
  double __pyx_v_panpos;
  double __pyx_v_read_frac_pos;
  double __pyx_v_grain_speed;
  double __pyx_v_density_frac_pos;
  double __pyx_v_grainlength_frac_pos;
  unsigned long __pyx_v_initial_grainlength;
  unsigned long __pyx_v_grainlength;
  unsigned long __pyx_v_preresample_grainlength;
  CYTHON_UNUSED unsigned long __pyx_v_target_grainlength;
  int __pyx_v_max_read_pos;
  double __pyx_v_read_pos;
  __Pyx_memviewslice __pyx_v_grain = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_grain_pre = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_grainchan = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_grainchan_pre = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_playhead;
  double __pyx_v_density;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_play", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pippi.grains._play", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grain, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grain_pre, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grainchan, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grainchan_pre, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">024</span>:     cdef int input_length = len(cloud.buf)</pre>
<pre class='cython code score-7 '>  __pyx_t_1 = ((PyObject *)__pyx_v_cloud-&gt;buf);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_input_length = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">025</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">026</span>:     cdef int fi = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_fi = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">027</span>:     cdef int ci = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_ci = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">028</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">029</span>:     cdef int write_pos = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_write_pos = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">030</span>:     cdef int write_inc = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_write_inc = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">031</span>:     cdef int start = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_start = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">032</span>:     cdef int end = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_end = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">033</span>:     cdef double panpos = 0.5</pre>
<pre class='cython code score-0 '>  __pyx_v_panpos = 0.5;
</pre><pre class="cython line score-0">&#xA0;<span class="">034</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>:     cdef double read_frac_pos = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_read_frac_pos = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>:     cdef double grain_speed = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_grain_speed = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">037</span>:     cdef double density_frac_pos = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_density_frac_pos = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">038</span>:     cdef double grainlength_frac_pos = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_grainlength_frac_pos = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">039</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">040</span>:     cdef unsigned long initial_grainlength = &lt;unsigned long&gt;(&lt;double&gt;cloud.samplerate * cloud.grainlength * 0.001)</pre>
<pre class='cython code score-0 '>  __pyx_v_initial_grainlength = ((unsigned long)((((double)__pyx_v_cloud-&gt;samplerate) * __pyx_v_cloud-&gt;grainlength) * 0.001));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">041</span>:     cdef unsigned long grainlength = initial_grainlength</pre>
<pre class='cython code score-0 '>  __pyx_v_grainlength = __pyx_v_initial_grainlength;
</pre><pre class="cython line score-0">&#xA0;<span class="">042</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">043</span>:     cdef unsigned long preresample_grainlength = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_preresample_grainlength = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">044</span>:     cdef unsigned long target_grainlength = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_target_grainlength = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">045</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">046</span>:     cdef int max_read_pos = input_length - grainlength</pre>
<pre class='cython code score-0 '>  __pyx_v_max_read_pos = (__pyx_v_input_length - __pyx_v_grainlength);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">047</span>:     cdef double read_pos = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_read_pos = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">048</span>:     cdef double[:,:] grain</pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>:     cdef double[:,:] grain_pre</pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>:     cdef double[:] grainchan</pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>:     cdef double[:] grainchan_pre</pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">053</span>:     cdef double playhead = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_playhead = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">054</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">055</span>:     while write_pos &lt; framelength - grainlength:</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_3 = ((__pyx_v_write_pos &lt; (__pyx_v_framelength - __pyx_v_grainlength)) != 0);
    if (!__pyx_t_3) break;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>:         playhead = &lt;double&gt;write_pos / framelength</pre>
<pre class='cython code score-5 '>    if (unlikely(__pyx_v_framelength == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
    }
    __pyx_v_playhead = (((double)__pyx_v_write_pos) / ((double)__pyx_v_framelength));
</pre><pre class="cython line score-0">&#xA0;<span class="">057</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>:         # Set (target) grain length</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">059</span>:         if cloud.grainlength_lfo is not None:</pre>
<pre class='cython code score-5 '>    if (unlikely(!__pyx_v_cloud-&gt;grainlength_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 59, __pyx_L1_error)</span>}
    __pyx_t_3 = ((((PyObject *) __pyx_v_cloud-&gt;grainlength_lfo.memview) != Py_None) != 0);
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:             grainlength_frac_pos = interpolation._linear_point(cloud.grainlength_lfo, playhead)</pre>
<pre class='cython code score-5 '>      if (unlikely(!__pyx_v_cloud-&gt;grainlength_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>}
      __pyx_v_grainlength_frac_pos = __pyx_f_5pippi_13interpolation__linear_point(__pyx_v_cloud-&gt;grainlength_lfo, __pyx_v_playhead);
</pre><pre class="cython line score-0">&#xA0;<span class="">061</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">062</span>:             if cloud.jitter &gt; 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_3 = ((__pyx_v_cloud-&gt;jitter &gt; 0.0) != 0);
      if (__pyx_t_3) {
/* … */
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">063</span>:                 grainlength_frac_pos = grainlength_frac_pos * ((rand()/&lt;double&gt;RAND_MAX) * cloud.jitter + 1)</pre>
<pre class='cython code score-5 '>        __pyx_t_4 = rand();
        if (unlikely(((double)RAND_MAX) == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 63, __pyx_L1_error)</span>
        }
        __pyx_v_grainlength_frac_pos = (__pyx_v_grainlength_frac_pos * (((((double)__pyx_t_4) / ((double)RAND_MAX)) * __pyx_v_cloud-&gt;jitter) + 1.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">064</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">065</span>:             grainlength = &lt;int&gt;(((grainlength_frac_pos * (cloud.maxlength - cloud.minlength)) + cloud.minlength) * (cloud.samplerate / 1000.0))</pre>
<pre class='cython code score-0 '>      __pyx_v_grainlength = ((int)(((__pyx_v_grainlength_frac_pos * (__pyx_v_cloud-&gt;maxlength - __pyx_v_cloud-&gt;minlength)) + __pyx_v_cloud-&gt;minlength) * (((double)__pyx_v_cloud-&gt;samplerate) / 1000.0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">066</span>:             max_read_pos = input_length - grainlength</pre>
<pre class='cython code score-0 '>      __pyx_v_max_read_pos = (__pyx_v_input_length - __pyx_v_grainlength);
</pre><pre class="cython line score-0">&#xA0;<span class="">067</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">068</span>:         if grainlength &lt; 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = ((__pyx_v_grainlength &lt; 0) != 0);
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">069</span>:             print(grainlength, write_pos)</pre>
<pre class='cython code score-15 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>(__pyx_v_grainlength);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_write_pos);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
      __pyx_t_1 = 0;
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">070</span>:             grainlength *= -1</pre>
<pre class='cython code score-0 '>      __pyx_v_grainlength = (__pyx_v_grainlength * -1L);
</pre><pre class="cython line score-0">&#xA0;<span class="">071</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>:         # Get read position for _cut</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">073</span>:         if cloud.freeze &gt;= 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = ((__pyx_v_cloud-&gt;freeze &gt;= 0.0) != 0);
    if (__pyx_t_3) {
/* … */
      goto __pyx_L8;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">074</span>:             read_pos = (cloud.samplerate * cloud.freeze)</pre>
<pre class='cython code score-0 '>      __pyx_v_read_pos = (__pyx_v_cloud-&gt;samplerate * __pyx_v_cloud-&gt;freeze);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">075</span>:             if read_pos &gt; &lt;double&gt;max_read_pos:</pre>
<pre class='cython code score-0 '>      __pyx_t_3 = ((__pyx_v_read_pos &gt; ((double)__pyx_v_max_read_pos)) != 0);
      if (__pyx_t_3) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">076</span>:                 read_pos = &lt;double&gt;max_read_pos</pre>
<pre class='cython code score-0 '>        __pyx_v_read_pos = ((double)__pyx_v_max_read_pos);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">077</span>:             read_frac_pos = read_pos / &lt;double&gt;max_read_pos</pre>
<pre class='cython code score-5 '>      if (unlikely(((double)__pyx_v_max_read_pos) == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 77, __pyx_L1_error)</span>
      }
      __pyx_v_read_frac_pos = (__pyx_v_read_pos / ((double)__pyx_v_max_read_pos));
</pre><pre class="cython line score-0">&#xA0;<span class="">078</span>:         else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">079</span>:             read_frac_pos = interpolation._linear_point(cloud.read_lfo, playhead)</pre>
<pre class='cython code score-5 '>    /*else*/ {
      if (unlikely(!__pyx_v_cloud-&gt;read_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 79, __pyx_L1_error)</span>}
      __pyx_v_read_frac_pos = __pyx_f_5pippi_13interpolation__linear_point(__pyx_v_cloud-&gt;read_lfo, __pyx_v_playhead);
    }
    __pyx_L8:;
</pre><pre class="cython line score-0">&#xA0;<span class="">080</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>:         start = &lt;int&gt;(read_frac_pos * max_read_pos)</pre>
<pre class='cython code score-0 '>    __pyx_v_start = ((int)(__pyx_v_read_frac_pos * __pyx_v_max_read_pos));
</pre><pre class="cython line score-0">&#xA0;<span class="">082</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>:         # Get grain speed</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">085</span>:         if cloud.speed_lfo is not None:</pre>
<pre class='cython code score-5 '>    if (unlikely(!__pyx_v_cloud-&gt;speed_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 85, __pyx_L1_error)</span>}
    __pyx_t_3 = ((((PyObject *) __pyx_v_cloud-&gt;speed_lfo.memview) != Py_None) != 0);
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:             grain_speed = interpolation._linear_point(cloud.speed_lfo, playhead)</pre>
<pre class='cython code score-5 '>      if (unlikely(!__pyx_v_cloud-&gt;speed_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span>}
      __pyx_v_grain_speed = __pyx_f_5pippi_13interpolation__linear_point(__pyx_v_cloud-&gt;speed_lfo, __pyx_v_playhead);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">087</span>:             cloud.speed = (grain_speed * (cloud.maxspeed - cloud.minspeed)) + cloud.minspeed</pre>
<pre class='cython code score-0 '>      __pyx_v_cloud-&gt;speed = ((__pyx_v_grain_speed * (__pyx_v_cloud-&gt;maxspeed - __pyx_v_cloud-&gt;minspeed)) + __pyx_v_cloud-&gt;minspeed);
</pre><pre class="cython line score-0">&#xA0;<span class="">088</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>:         ############################</pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>:         # Cut grain and pitch shift</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">092</span>:         if cloud.speed != 1:</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = ((__pyx_v_cloud-&gt;speed != 1.0) != 0);
    if (__pyx_t_3) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">093</span>:             # Length of segment to copy from source buffer: grainlength * speed</pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>:             #cloud.speed = cloud.speed if cloud.speed &gt; cloud.minspeed else cloud.minspeed</pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>:             #cloud.speed = cloud.speed if cloud.speed &lt; cloud.maxspeed else cloud.maxspeed</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">096</span>:             preresample_grainlength = &lt;unsigned long&gt;(grainlength * cloud.speed)</pre>
<pre class='cython code score-0 '>      __pyx_v_preresample_grainlength = ((unsigned long)(__pyx_v_grainlength * __pyx_v_cloud-&gt;speed));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">097</span>:             if preresample_grainlength &gt; (framelength - start):</pre>
<pre class='cython code score-0 '>      __pyx_t_3 = ((__pyx_v_preresample_grainlength &gt; (__pyx_v_framelength - __pyx_v_start)) != 0);
      if (__pyx_t_3) {
/* … */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">098</span>:                 # get min(available_length, preresample_length)</pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>:                 # adjust target/grainlength to match speed based on available length</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">100</span>:                 preresample_grainlength = framelength - start</pre>
<pre class='cython code score-0 '>        __pyx_v_preresample_grainlength = (__pyx_v_framelength - __pyx_v_start);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">101</span>:                 cloud.speed = &lt;double&gt;preresample_grainlength / grainlength</pre>
<pre class='cython code score-5 '>        if (unlikely(__pyx_v_grainlength == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 101, __pyx_L1_error)</span>
        }
        __pyx_v_cloud-&gt;speed = (((double)__pyx_v_preresample_grainlength) / ((double)__pyx_v_grainlength));
</pre><pre class="cython line score-0">&#xA0;<span class="">102</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>:             # TODO can probably init maxlength versions of these outside the loop,</pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>:             # and reuse them in sequence (careful of gil-releasing...)</pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">106</span>:             grain_pre = np.zeros((preresample_grainlength, cloud.channels), dtype='d')</pre>
<pre class='cython code score-37 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>(__pyx_v_preresample_grainlength);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_cloud-&gt;channels);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_1);
      __pyx_t_5 = 0;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_n_u_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 106, __pyx_L1_error)</span>
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grain_pre, 1);
      __pyx_v_grain_pre = __pyx_t_8;
      __pyx_t_8.memview = NULL;
      __pyx_t_8.data = NULL;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">107</span>:             grainchan_pre = np.zeros(preresample_grainlength, dtype='d')</pre>
<pre class='cython code score-28 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>(__pyx_v_preresample_grainlength);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_n_u_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grainchan_pre, 1);
      __pyx_v_grainchan_pre = __pyx_t_9;
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">108</span>:             grain = np.zeros((grainlength, cloud.channels), dtype='d')</pre>
<pre class='cython code score-37 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>(__pyx_v_grainlength);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_cloud-&gt;channels);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_1);
      __pyx_t_6 = 0;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_n_u_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 108, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grain, 1);
      __pyx_v_grain = __pyx_t_8;
      __pyx_t_8.memview = NULL;
      __pyx_t_8.data = NULL;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">109</span>:             grainchan = np.zeros(grainlength, dtype='d')</pre>
<pre class='cython code score-28 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>(__pyx_v_grainlength);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_n_u_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 109, __pyx_L1_error)</span>
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grainchan, 1);
      __pyx_v_grainchan = __pyx_t_9;
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">110</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">111</span>:             grain_pre = _cut(cloud.buf.frames, framelength, start, preresample_grainlength)</pre>
<pre class='cython code score-5 '>      if (unlikely(!__pyx_v_cloud-&gt;buf-&gt;frames.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>}
      __pyx_t_8 = __pyx_f_5pippi_11soundbuffer__cut(__pyx_v_cloud-&gt;buf-&gt;frames, __pyx_v_framelength, __pyx_v_start, __pyx_v_preresample_grainlength);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grain_pre, 1);
      __pyx_v_grain_pre = __pyx_t_8;
      __pyx_t_8.memview = NULL;
      __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">112</span>:             grain = _speed(grain_pre, grain, grainchan_pre, grainchan, cloud.channels)</pre>
<pre class='cython code score-0 '>      __pyx_t_8 = __pyx_f_5pippi_11soundbuffer__speed(__pyx_v_grain_pre, __pyx_v_grain, __pyx_v_grainchan_pre, __pyx_v_grainchan, __pyx_v_cloud-&gt;channels);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 112, __pyx_L1_error)</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grain, 1);
      __pyx_v_grain = __pyx_t_8;
      __pyx_t_8.memview = NULL;
      __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">113</span>:         else:</pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:             grain = np.zeros((grainlength, cloud.channels), dtype='d')</pre>
<pre class='cython code score-37 '>    /*else*/ {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>(__pyx_v_grainlength);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_cloud-&gt;channels);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_1);
      __pyx_t_5 = 0;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_n_u_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grain, 1);
      __pyx_v_grain = __pyx_t_8;
      __pyx_t_8.memview = NULL;
      __pyx_t_8.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:             grain = _cut(cloud.buf.frames, framelength, start, grainlength)</pre>
<pre class='cython code score-5 '>      if (unlikely(!__pyx_v_cloud-&gt;buf-&gt;frames.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span>}
      __pyx_t_8 = __pyx_f_5pippi_11soundbuffer__cut(__pyx_v_cloud-&gt;buf-&gt;frames, __pyx_v_framelength, __pyx_v_start, __pyx_v_grainlength);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grain, 1);
      __pyx_v_grain = __pyx_t_8;
      __pyx_t_8.memview = NULL;
      __pyx_t_8.data = NULL;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">116</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">117</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">118</span>:         # Apply grain window</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:         grain = _env(grain, cloud.channels, cloud.win)</pre>
<pre class='cython code score-5 '>    if (unlikely(!__pyx_v_cloud-&gt;win.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_f_5pippi_11soundbuffer__env(__pyx_v_grain, __pyx_v_cloud-&gt;channels, __pyx_v_cloud-&gt;win);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 119, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grain, 1);
    __pyx_v_grain = __pyx_t_8;
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">120</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">121</span>:         # Pan grain if spread &gt; 0</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>:         if cloud.spread &gt; 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = ((__pyx_v_cloud-&gt;spread &gt; 0.0) != 0);
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:             panpos = (rand()/&lt;double&gt;RAND_MAX) * cloud.spread + (0.5 - (cloud.spread * 0.5))</pre>
<pre class='cython code score-5 '>      __pyx_t_4 = rand();
      if (unlikely(((double)RAND_MAX) == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
      }
      __pyx_v_panpos = (((((double)__pyx_t_4) / ((double)RAND_MAX)) * __pyx_v_cloud-&gt;spread) + (0.5 - (__pyx_v_cloud-&gt;spread * 0.5)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">124</span>:             grain = _pan(grain, grainlength, cloud.channels, panpos, wavetables.CONSTANT)</pre>
<pre class='cython code score-0 '>      __pyx_t_8 = __pyx_f_5pippi_11soundbuffer__pan(__pyx_v_grain, __pyx_v_grainlength, __pyx_v_cloud-&gt;channels, __pyx_v_panpos, __pyx_v_5pippi_10wavetables_CONSTANT);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 124, __pyx_L1_error)</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grain, 1);
      __pyx_v_grain = __pyx_t_8;
      __pyx_t_8.memview = NULL;
      __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">125</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">127</span>:         # Dub grain to output</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:         if write_pos + len(grain) &lt; len(out):</pre>
<pre class='cython code score-4 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_grain); 
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_out); 
    __pyx_t_3 = (((__pyx_v_write_pos + __pyx_t_10) &lt; __pyx_t_11) != 0);
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>:             for fi in range(len(grain)):</pre>
<pre class='cython code score-2 '>      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_grain); 
      __pyx_t_2 = __pyx_t_11;
      for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_2; __pyx_t_4+=1) {
        __pyx_v_fi = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">130</span>:                 for ci in range(cloud.channels):</pre>
<pre class='cython code score-0 '>        __pyx_t_12 = __pyx_v_cloud-&gt;channels;
        __pyx_t_13 = __pyx_t_12;
        for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
          __pyx_v_ci = __pyx_t_14;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:                     out[fi + write_pos, ci] += (grain[fi, ci] * cloud.amp)</pre>
<pre class='cython code score-4 '>          __pyx_t_15 = __pyx_v_fi;
          __pyx_t_16 = __pyx_v_ci;
          __pyx_t_17 = -1;
          if (__pyx_t_15 &lt; 0) {
            __pyx_t_15 += __pyx_v_grain.shape[0];
            if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_17 = 0;
          } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_grain.shape[0])) __pyx_t_17 = 0;
          if (__pyx_t_16 &lt; 0) {
            __pyx_t_16 += __pyx_v_grain.shape[1];
            if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_17 = 1;
          } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_grain.shape[1])) __pyx_t_17 = 1;
          if (unlikely(__pyx_t_17 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
            <span class='error_goto'>__PYX_ERR(0, 131, __pyx_L1_error)</span>
          }
          __pyx_t_18 = (__pyx_v_fi + __pyx_v_write_pos);
          __pyx_t_19 = __pyx_v_ci;
          __pyx_t_17 = -1;
          if (__pyx_t_18 &lt; 0) {
            __pyx_t_18 += __pyx_v_out.shape[0];
            if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_17 = 0;
          } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_out.shape[0])) __pyx_t_17 = 0;
          if (__pyx_t_19 &lt; 0) {
            __pyx_t_19 += __pyx_v_out.shape[1];
            if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_17 = 1;
          } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_out.shape[1])) __pyx_t_17 = 1;
          if (unlikely(__pyx_t_17 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
            <span class='error_goto'>__PYX_ERR(0, 131, __pyx_L1_error)</span>
          }
          *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_18 * __pyx_v_out.strides[0]) ) + __pyx_t_19 * __pyx_v_out.strides[1]) )) += ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_grain.data + __pyx_t_15 * __pyx_v_grain.strides[0]) ) + __pyx_t_16 * __pyx_v_grain.strides[1]) ))) * __pyx_v_cloud-&gt;amp);
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">132</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">133</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">134</span>:         # Get density for write_inc modulation</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:         if cloud.density_lfo is not None:</pre>
<pre class='cython code score-5 '>    if (unlikely(!__pyx_v_cloud-&gt;density_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>}
    __pyx_t_3 = ((((PyObject *) __pyx_v_cloud-&gt;density_lfo.memview) != Py_None) != 0);
    if (__pyx_t_3) {
/* … */
      goto __pyx_L19;
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">136</span>:             density_frac_pos = interpolation._linear_point(cloud.density_lfo, playhead)</pre>
<pre class='cython code score-5 '>      if (unlikely(!__pyx_v_cloud-&gt;density_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 136, __pyx_L1_error)</span>}
      __pyx_v_density_frac_pos = __pyx_f_5pippi_13interpolation__linear_point(__pyx_v_cloud-&gt;density_lfo, __pyx_v_playhead);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">137</span>:             density = (density_frac_pos * (cloud.maxdensity - cloud.mindensity)) + cloud.mindensity</pre>
<pre class='cython code score-0 '>      __pyx_v_density = ((__pyx_v_density_frac_pos * (__pyx_v_cloud-&gt;maxdensity - __pyx_v_cloud-&gt;mindensity)) + __pyx_v_cloud-&gt;mindensity);
</pre><pre class="cython line score-0">&#xA0;<span class="">138</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>:             density = cloud.density</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_20 = __pyx_v_cloud-&gt;density;
      __pyx_v_density = __pyx_t_20;
    }
    __pyx_L19:;
</pre><pre class="cython line score-0">&#xA0;<span class="">140</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>:         # Increment write_pos based on grainlength &amp; density</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">142</span>:         try:</pre>
<pre class='cython code score-11 '>    {
      /*try:*/ {
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      goto __pyx_L27_try_end;
      __pyx_L20_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
/* … */
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_21);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_22);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_23);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_21, __pyx_t_22, __pyx_t_23);
      goto __pyx_L1_error;
      __pyx_L21_exception_handled:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_21);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_22);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_23);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_21, __pyx_t_22, __pyx_t_23);
      __pyx_L27_try_end:;
    }
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:             cloud.grains_per_sec = &lt;double&gt;cloud.samplerate / (&lt;double&gt;len(grain) / 2.0)</pre>
<pre class='cython code score-7 '>        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_grain); 
        __pyx_t_20 = (((double)__pyx_t_11) / 2.0);
        if (unlikely(__pyx_t_20 == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 143, __pyx_L20_error)</span>
        }
        __pyx_v_cloud-&gt;grains_per_sec = (((double)__pyx_v_cloud-&gt;samplerate) / __pyx_t_20);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">144</span>:             cloud.grains_per_sec *= density</pre>
<pre class='cython code score-0 '>        __pyx_v_cloud-&gt;grains_per_sec = (__pyx_v_cloud-&gt;grains_per_sec * __pyx_v_density);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:             write_inc = &lt;int&gt;(&lt;double&gt;cloud.samplerate / cloud.grains_per_sec)</pre>
<pre class='cython code score-5 '>        if (unlikely(__pyx_v_cloud-&gt;grains_per_sec == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 145, __pyx_L20_error)</span>
        }
        __pyx_v_write_inc = ((int)(((double)__pyx_v_cloud-&gt;samplerate) / __pyx_v_cloud-&gt;grains_per_sec));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:             if write_inc &lt; MIN_GRAIN_FRAMELENGTH:</pre>
<pre class='cython code score-0 '>        __pyx_t_3 = ((__pyx_v_write_inc &lt; 0x1B9) != 0);
        if (__pyx_t_3) {
/* … */
          goto __pyx_L28;
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">147</span>:                 write_pos += MIN_GRAIN_FRAMELENGTH</pre>
<pre class='cython code score-0 '>          __pyx_v_write_pos = (__pyx_v_write_pos + 0x1B9);
</pre><pre class="cython line score-0">&#xA0;<span class="">148</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:                 write_pos += write_inc</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_write_pos = (__pyx_v_write_pos + __pyx_v_write_inc);
        }
        __pyx_L28:;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">150</span>:         except ZeroDivisionError:</pre>
<pre class='cython code score-6 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(__pyx_builtin_ZeroDivisionError);
      if (__pyx_t_4) {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pippi.grains._play", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_5, &amp;__pyx_t_7, &amp;__pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L22_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:             write_pos += MIN_GRAIN_FRAMELENGTH</pre>
<pre class='cython code score-3 '>        __pyx_v_write_pos = (__pyx_v_write_pos + 0x1B9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L21_exception_handled;
      }
      goto __pyx_L22_except_error;
      __pyx_L22_except_error:;
</pre><pre class="cython line score-0">&#xA0;<span class="">152</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:     return out</pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_out, 0);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">154</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">155</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>: cdef class GrainCloud:</pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_5pippi_6grains_GrainCloud {
  struct __pyx_obj_5pippi_11soundbuffer_SoundBuffer *(*play)(struct __pyx_obj_5pippi_6grains_GrainCloud *, int __pyx_skip_dispatch, struct __pyx_opt_args_5pippi_6grains_10GrainCloud_play *__pyx_optional_args);
};
static struct __pyx_vtabstruct_5pippi_6grains_GrainCloud *__pyx_vtabptr_5pippi_6grains_GrainCloud;

</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">157</span>:     def __init__(self,</pre>
<pre class='cython code score-7 '>/* Python wrapper */
static int __pyx_pw_5pippi_6grains_10GrainCloud_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_5pippi_6grains_10GrainCloud_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_5pippi_11soundbuffer_SoundBuffer *__pyx_v_buf = 0;
  int __pyx_v_win;
  __Pyx_memviewslice __pyx_v_win_wt = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_win_length;
  PyObject *__pyx_v_mask = 0;
  double __pyx_v_freeze;
  int __pyx_v_read_lfo;
  PyObject *__pyx_v_read_lfo_wt = 0;
  double __pyx_v_read_lfo_speed;
  unsigned int __pyx_v_read_lfo_length;
  int __pyx_v_speed_lfo;
  __Pyx_memviewslice __pyx_v_speed_lfo_wt = { 0, 0, { 0 }, { 0 }, { 0 } };
  unsigned int __pyx_v_speed_lfo_length;
  double __pyx_v_speed;
  double __pyx_v_minspeed;
  double __pyx_v_maxspeed;
  int __pyx_v_density_lfo;
  __Pyx_memviewslice __pyx_v_density_lfo_wt = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_density_lfo_length;
  double __pyx_v_density_lfo_speed;
  double __pyx_v_density;
  double __pyx_v_mindensity;
  double __pyx_v_maxdensity;
  double __pyx_v_grainlength;
  int __pyx_v_grainlength_lfo;
  __Pyx_memviewslice __pyx_v_grainlength_lfo_wt = { 0, 0, { 0 }, { 0 }, { 0 } };
  unsigned int __pyx_v_grainlength_lfo_length;
  double __pyx_v_grainlength_lfo_speed;
  double __pyx_v_minlength;
  double __pyx_v_maxlength;
  double __pyx_v_spread;
  double __pyx_v_jitter;
  double __pyx_v_amp;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_buf,&amp;__pyx_n_s_win,&amp;__pyx_n_s_win_wt,&amp;__pyx_n_s_win_length,&amp;__pyx_n_s_mask,&amp;__pyx_n_s_freeze,&amp;__pyx_n_s_read_lfo,&amp;__pyx_n_s_read_lfo_wt,&amp;__pyx_n_s_read_lfo_speed,&amp;__pyx_n_s_read_lfo_length,&amp;__pyx_n_s_speed_lfo,&amp;__pyx_n_s_speed_lfo_wt,&amp;__pyx_n_s_speed_lfo_length,&amp;__pyx_n_s_speed,&amp;__pyx_n_s_minspeed,&amp;__pyx_n_s_maxspeed,&amp;__pyx_n_s_density_lfo,&amp;__pyx_n_s_density_lfo_wt,&amp;__pyx_n_s_density_lfo_length,&amp;__pyx_n_s_density_lfo_speed,&amp;__pyx_n_s_density,&amp;__pyx_n_s_mindensity,&amp;__pyx_n_s_maxdensity,&amp;__pyx_n_s_grainlength,&amp;__pyx_n_s_grainlength_lfo,&amp;__pyx_n_s_grainlength_lfo_wt,&amp;__pyx_n_s_grainlength_lfo_length,&amp;__pyx_n_s_grainlength_lfo_speed,&amp;__pyx_n_s_minlength,&amp;__pyx_n_s_maxlength,&amp;__pyx_n_s_spread,&amp;__pyx_n_s_jitter,&amp;__pyx_n_s_amp,0};
    PyObject* values[33] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5pippi_6grains_10GrainCloud___init__(struct __pyx_obj_5pippi_6grains_GrainCloud *__pyx_v_self, struct __pyx_obj_5pippi_11soundbuffer_SoundBuffer *__pyx_v_buf, int __pyx_v_win, __Pyx_memviewslice __pyx_v_win_wt, int __pyx_v_win_length, PyObject *__pyx_v_mask, double __pyx_v_freeze, int __pyx_v_read_lfo, PyObject *__pyx_v_read_lfo_wt, double __pyx_v_read_lfo_speed, unsigned int __pyx_v_read_lfo_length, int __pyx_v_speed_lfo, __Pyx_memviewslice __pyx_v_speed_lfo_wt, unsigned int __pyx_v_speed_lfo_length, double __pyx_v_speed, double __pyx_v_minspeed, double __pyx_v_maxspeed, int __pyx_v_density_lfo, __Pyx_memviewslice __pyx_v_density_lfo_wt, int __pyx_v_density_lfo_length, double __pyx_v_density_lfo_speed, double __pyx_v_density, double __pyx_v_mindensity, double __pyx_v_maxdensity, double __pyx_v_grainlength, int __pyx_v_grainlength_lfo, __Pyx_memviewslice __pyx_v_grainlength_lfo_wt, unsigned int __pyx_v_grainlength_lfo_length, double __pyx_v_grainlength_lfo_speed, double __pyx_v_minlength, double __pyx_v_maxlength, double __pyx_v_spread, double __pyx_v_jitter, double __pyx_v_amp) {
  arrayobject *__pyx_v_cmask = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pippi.grains.GrainCloud.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_cmask);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_win_wt, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_speed_lfo_wt, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_density_lfo_wt, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_grainlength_lfo_wt, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">158</span>:             SoundBuffer buf,</pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>:             int win=-1,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">161</span>:             double[:] win_wt=None,</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(Py_None, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
  __pyx_k_ = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">162</span>:             int win_length=DEFAULT_WTSIZE,</pre>
<pre class="cython line score-0">&#xA0;<span class="">163</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:             list mask=None,</pre>
<pre class='cython code score-0 '>    values[4] = ((PyObject*)Py_None);
</pre><pre class="cython line score-0">&#xA0;<span class="">165</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">166</span>:             double freeze=-1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">167</span>:             int read_lfo=-1,</pre>
<pre class="cython line score-388" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">168</span>:             object read_lfo_wt=None,</pre>
<pre class='cython code score-388 '>    values[7] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 33: values[32] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 32);
        CYTHON_FALLTHROUGH;
        case 32: values[31] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 31);
        CYTHON_FALLTHROUGH;
        case 31: values[30] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 30);
        CYTHON_FALLTHROUGH;
        case 30: values[29] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 29);
        CYTHON_FALLTHROUGH;
        case 29: values[28] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 28);
        CYTHON_FALLTHROUGH;
        case 28: values[27] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 27);
        CYTHON_FALLTHROUGH;
        case 27: values[26] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 26);
        CYTHON_FALLTHROUGH;
        case 26: values[25] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 25);
        CYTHON_FALLTHROUGH;
        case 25: values[24] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 24);
        CYTHON_FALLTHROUGH;
        case 24: values[23] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 23);
        CYTHON_FALLTHROUGH;
        case 23: values[22] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 22);
        CYTHON_FALLTHROUGH;
        case 22: values[21] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buf)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_win);
          if (value) { values[1] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_win_wt);
          if (value) { values[2] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_win_length);
          if (value) { values[3] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_mask);
          if (value) { values[4] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_freeze);
          if (value) { values[5] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_read_lfo);
          if (value) { values[6] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_read_lfo_wt);
          if (value) { values[7] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_read_lfo_speed);
          if (value) { values[8] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_read_lfo_length);
          if (value) { values[9] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_speed_lfo);
          if (value) { values[10] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_speed_lfo_wt);
          if (value) { values[11] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_speed_lfo_length);
          if (value) { values[12] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_speed);
          if (value) { values[13] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_minspeed);
          if (value) { values[14] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_maxspeed);
          if (value) { values[15] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_density_lfo);
          if (value) { values[16] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_density_lfo_wt);
          if (value) { values[17] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 18:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_density_lfo_length);
          if (value) { values[18] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 19:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_density_lfo_speed);
          if (value) { values[19] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 20:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_density);
          if (value) { values[20] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 21:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_mindensity);
          if (value) { values[21] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 22:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_maxdensity);
          if (value) { values[22] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 23:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_grainlength);
          if (value) { values[23] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 24:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_grainlength_lfo);
          if (value) { values[24] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 25:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_grainlength_lfo_wt);
          if (value) { values[25] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 26:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_grainlength_lfo_length);
          if (value) { values[26] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 27:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_grainlength_lfo_speed);
          if (value) { values[27] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 28:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_minlength);
          if (value) { values[28] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 29:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_maxlength);
          if (value) { values[29] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 30:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_spread);
          if (value) { values[30] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 31:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_jitter);
          if (value) { values[31] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 32:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_amp);
          if (value) { values[32] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 157, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case 33: values[32] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 32);
        CYTHON_FALLTHROUGH;
        case 32: values[31] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 31);
        CYTHON_FALLTHROUGH;
        case 31: values[30] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 30);
        CYTHON_FALLTHROUGH;
        case 30: values[29] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 29);
        CYTHON_FALLTHROUGH;
        case 29: values[28] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 28);
        CYTHON_FALLTHROUGH;
        case 28: values[27] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 27);
        CYTHON_FALLTHROUGH;
        case 27: values[26] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 26);
        CYTHON_FALLTHROUGH;
        case 26: values[25] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 25);
        CYTHON_FALLTHROUGH;
        case 25: values[24] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 24);
        CYTHON_FALLTHROUGH;
        case 24: values[23] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 23);
        CYTHON_FALLTHROUGH;
        case 23: values[22] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 22);
        CYTHON_FALLTHROUGH;
        case 22: values[21] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_buf = ((struct __pyx_obj_5pippi_11soundbuffer_SoundBuffer *)values[0]);
    if (values[1]) {
      __pyx_v_win = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_win == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 160, __pyx_L3_error)</span>
    } else {
      __pyx_v_win = ((int)-1);
    }
    if (values[2]) {
      __pyx_v_win_wt = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_win_wt.memview)) __PYX_ERR(0, 161, __pyx_L3_error)</span>
    } else {
      __pyx_v_win_wt = __pyx_k_;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_win_wt, 1);
    }
    if (values[3]) {
      __pyx_v_win_length = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_win_length == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 162, __pyx_L3_error)</span>
    } else {
      __pyx_v_win_length = ((int)0x1000);
    }
    __pyx_v_mask = ((PyObject*)values[4]);
    if (values[5]) {
      __pyx_v_freeze = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_freeze == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 166, __pyx_L3_error)</span>
    } else {
      __pyx_v_freeze = ((double)-1.0);
    }
    if (values[6]) {
      __pyx_v_read_lfo = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_read_lfo == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 167, __pyx_L3_error)</span>
    } else {
      __pyx_v_read_lfo = ((int)-1);
    }
    __pyx_v_read_lfo_wt = values[7];
    if (values[8]) {
      __pyx_v_read_lfo_speed = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[8]); if (unlikely((__pyx_v_read_lfo_speed == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L3_error)</span>
    } else {
      __pyx_v_read_lfo_speed = ((double)1.0);
    }
    if (values[9]) {
      __pyx_v_read_lfo_length = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(values[9]); if (unlikely((__pyx_v_read_lfo_length == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 170, __pyx_L3_error)</span>
    } else {
      __pyx_v_read_lfo_length = ((unsigned int)0x1000);
    }
    if (values[10]) {
      __pyx_v_speed_lfo = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[10]); if (unlikely((__pyx_v_speed_lfo == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 172, __pyx_L3_error)</span>
    } else {
      __pyx_v_speed_lfo = ((int)-1);
    }
    if (values[11]) {
      __pyx_v_speed_lfo_wt = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[11], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_speed_lfo_wt.memview)) __PYX_ERR(0, 173, __pyx_L3_error)</span>
    } else {
      __pyx_v_speed_lfo_wt = __pyx_k__2;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_speed_lfo_wt, 1);
    }
    if (values[12]) {
      __pyx_v_speed_lfo_length = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(values[12]); if (unlikely((__pyx_v_speed_lfo_length == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 174, __pyx_L3_error)</span>
    } else {
      __pyx_v_speed_lfo_length = ((unsigned int)0x1000);
    }
    if (values[13]) {
      __pyx_v_speed = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[13]); if (unlikely((__pyx_v_speed == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 175, __pyx_L3_error)</span>
    } else {
      __pyx_v_speed = ((double)1.0);
    }
    if (values[14]) {
      __pyx_v_minspeed = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[14]); if (unlikely((__pyx_v_minspeed == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 176, __pyx_L3_error)</span>
    } else {
      __pyx_v_minspeed = ((double)1.0);
    }
    if (values[15]) {
      __pyx_v_maxspeed = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[15]); if (unlikely((__pyx_v_maxspeed == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 177, __pyx_L3_error)</span>
    } else {
      __pyx_v_maxspeed = ((double)2.0);
    }
    if (values[16]) {
      __pyx_v_density_lfo = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[16]); if (unlikely((__pyx_v_density_lfo == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L3_error)</span>
    } else {
      __pyx_v_density_lfo = ((int)-1);
    }
    if (values[17]) {
      __pyx_v_density_lfo_wt = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[17], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_density_lfo_wt.memview)) __PYX_ERR(0, 180, __pyx_L3_error)</span>
    } else {
      __pyx_v_density_lfo_wt = __pyx_k__3;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_density_lfo_wt, 1);
    }
    if (values[18]) {
      __pyx_v_density_lfo_length = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[18]); if (unlikely((__pyx_v_density_lfo_length == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 181, __pyx_L3_error)</span>
    } else {
      __pyx_v_density_lfo_length = ((int)0x1000);
    }
    if (values[19]) {
      __pyx_v_density_lfo_speed = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[19]); if (unlikely((__pyx_v_density_lfo_speed == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 182, __pyx_L3_error)</span>
    } else {
      __pyx_v_density_lfo_speed = ((double)1.0);
    }
    if (values[20]) {
      __pyx_v_density = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[20]); if (unlikely((__pyx_v_density == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 183, __pyx_L3_error)</span>
    } else {
      __pyx_v_density = ((double)1.0);
    }
    if (values[21]) {
      __pyx_v_mindensity = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[21]); if (unlikely((__pyx_v_mindensity == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 184, __pyx_L3_error)</span>
    } else {
      __pyx_v_mindensity = ((double)0.5);
    }
    if (values[22]) {
      __pyx_v_maxdensity = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[22]); if (unlikely((__pyx_v_maxdensity == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 185, __pyx_L3_error)</span>
    } else {
      __pyx_v_maxdensity = ((double)1.5);
    }
    if (values[23]) {
      __pyx_v_grainlength = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[23]); if (unlikely((__pyx_v_grainlength == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L3_error)</span>
    } else {
      __pyx_v_grainlength = ((double)60.0);
    }
    if (values[24]) {
      __pyx_v_grainlength_lfo = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[24]); if (unlikely((__pyx_v_grainlength_lfo == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L3_error)</span>
    } else {
      __pyx_v_grainlength_lfo = ((int)-1);
    }
    if (values[25]) {
      __pyx_v_grainlength_lfo_wt = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[25], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_grainlength_lfo_wt.memview)) __PYX_ERR(0, 189, __pyx_L3_error)</span>
    } else {
      __pyx_v_grainlength_lfo_wt = __pyx_k__4;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_grainlength_lfo_wt, 1);
    }
    if (values[26]) {
      __pyx_v_grainlength_lfo_length = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(values[26]); if (unlikely((__pyx_v_grainlength_lfo_length == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L3_error)</span>
    } else {
      __pyx_v_grainlength_lfo_length = ((unsigned int)0x1000);
    }
    if (values[27]) {
      __pyx_v_grainlength_lfo_speed = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[27]); if (unlikely((__pyx_v_grainlength_lfo_speed == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L3_error)</span>
    } else {
      __pyx_v_grainlength_lfo_speed = ((double)1.0);
    }
    if (values[28]) {
      __pyx_v_minlength = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[28]); if (unlikely((__pyx_v_minlength == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 193, __pyx_L3_error)</span>
    } else {
      __pyx_v_minlength = ((double)60.0);
    }
    if (values[29]) {
      __pyx_v_maxlength = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[29]); if (unlikely((__pyx_v_maxlength == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 194, __pyx_L3_error)</span>
    } else {
      __pyx_v_maxlength = ((double)80.0);
    }
    if (values[30]) {
      __pyx_v_spread = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[30]); if (unlikely((__pyx_v_spread == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 195, __pyx_L3_error)</span>
    } else {
      __pyx_v_spread = ((double)0.0);
    }
    if (values[31]) {
      __pyx_v_jitter = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[31]); if (unlikely((__pyx_v_jitter == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L3_error)</span>
    } else {
      __pyx_v_jitter = ((double)0.0);
    }
    if (values[32]) {
      __pyx_v_amp = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[32]); if (unlikely((__pyx_v_amp == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 197, __pyx_L3_error)</span>
    } else {
      __pyx_v_amp = ((double)1.0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 33, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 157, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pippi.grains.GrainCloud.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_buf), __pyx_ptype_5pippi_11soundbuffer_SoundBuffer, 1, "buf", 0))) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_mask), (&amp;PyList_Type), 1, "mask", 1))) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_5pippi_6grains_10GrainCloud___init__(((struct __pyx_obj_5pippi_6grains_GrainCloud *)__pyx_v_self), __pyx_v_buf, __pyx_v_win, __pyx_v_win_wt, __pyx_v_win_length, __pyx_v_mask, __pyx_v_freeze, __pyx_v_read_lfo, __pyx_v_read_lfo_wt, __pyx_v_read_lfo_speed, __pyx_v_read_lfo_length, __pyx_v_speed_lfo, __pyx_v_speed_lfo_wt, __pyx_v_speed_lfo_length, __pyx_v_speed, __pyx_v_minspeed, __pyx_v_maxspeed, __pyx_v_density_lfo, __pyx_v_density_lfo_wt, __pyx_v_density_lfo_length, __pyx_v_density_lfo_speed, __pyx_v_density, __pyx_v_mindensity, __pyx_v_maxdensity, __pyx_v_grainlength, __pyx_v_grainlength_lfo, __pyx_v_grainlength_lfo_wt, __pyx_v_grainlength_lfo_length, __pyx_v_grainlength_lfo_speed, __pyx_v_minlength, __pyx_v_maxlength, __pyx_v_spread, __pyx_v_jitter, __pyx_v_amp);
</pre><pre class="cython line score-0">&#xA0;<span class="">169</span>:             double read_lfo_speed=1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">170</span>:             unsigned int read_lfo_length=DEFAULT_WTSIZE,</pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>:             int speed_lfo=-1,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:             double[:] speed_lfo_wt=None,</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(Py_None, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 173, __pyx_L1_error)</span>
  __pyx_k__2 = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">174</span>:             unsigned int speed_lfo_length=DEFAULT_WTSIZE,</pre>
<pre class="cython line score-0">&#xA0;<span class="">175</span>:             double speed=DEFAULT_SPEED,</pre>
<pre class="cython line score-0">&#xA0;<span class="">176</span>:             double minspeed=DEFAULT_SPEED,</pre>
<pre class="cython line score-0">&#xA0;<span class="">177</span>:             double maxspeed=DEFAULT_MAXSPEED,</pre>
<pre class="cython line score-0">&#xA0;<span class="">178</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">179</span>:             int density_lfo=-1,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">180</span>:             double[:] density_lfo_wt=None,</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(Py_None, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
  __pyx_k__3 = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">181</span>:             int density_lfo_length=DEFAULT_WTSIZE,</pre>
<pre class="cython line score-0">&#xA0;<span class="">182</span>:             double density_lfo_speed=1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>:             double density=DEFAULT_DENSITY,</pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>:             double mindensity=DEFAULT_MINDENSITY,</pre>
<pre class="cython line score-0">&#xA0;<span class="">185</span>:             double maxdensity=DEFAULT_MAXDENSITY,</pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>:             double grainlength=DEFAULT_GRAINLENGTH,</pre>
<pre class="cython line score-0">&#xA0;<span class="">188</span>:             int grainlength_lfo=-1,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>:             double[:] grainlength_lfo_wt=None,</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(Py_None, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
  __pyx_k__4 = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">190</span>:             unsigned int grainlength_lfo_length=DEFAULT_WTSIZE,</pre>
<pre class="cython line score-0">&#xA0;<span class="">191</span>:             double grainlength_lfo_speed=1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>:             double minlength=DEFAULT_GRAINLENGTH,    # min grain length in ms</pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>:             double maxlength=DEFAULT_MAXGRAINLENGTH,    # max grain length in ms</pre>
<pre class="cython line score-0">&#xA0;<span class="">195</span>:             double spread=0,        # 0 = no panning, 1 = max random panning</pre>
<pre class="cython line score-0">&#xA0;<span class="">196</span>:             double jitter=0,        # rhythm 0=regular, 1=totally random</pre>
<pre class="cython line score-0">&#xA0;<span class="">197</span>:             double amp=1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">198</span>:         ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">199</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">200</span>:         if spread &lt; 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_spread &lt; 0.0) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">201</span>:             spread = 0</pre>
<pre class='cython code score-0 '>    __pyx_v_spread = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:         elif spread &gt; 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_spread &gt; 1.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:             spread = 1</pre>
<pre class='cython code score-0 '>    __pyx_v_spread = 1.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">204</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>:         self.buf = buf</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_buf));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_buf));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;buf);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;buf));
  __pyx_v_self-&gt;buf = __pyx_v_buf;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>:         self.channels = buf.channels</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_buf-&gt;channels;
  __pyx_v_self-&gt;channels = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:         self.samplerate = buf.samplerate</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_buf-&gt;samplerate;
  __pyx_v_self-&gt;samplerate = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:         self.spread = spread</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;spread = __pyx_v_spread;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:         self.jitter = jitter</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;jitter = __pyx_v_jitter;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:         self.freeze = freeze</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;freeze = __pyx_v_freeze;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:         self.amp = amp</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;amp = __pyx_v_amp;
</pre><pre class="cython line score-0">&#xA0;<span class="">212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">213</span>:         cdef array.array cmask</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>:         if mask is not None:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_mask != ((PyObject*)Py_None));
  __pyx_t_3 = (__pyx_t_1 != 0);
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:             cmask = array.array('i', mask)</pre>
<pre class='cython code score-12 '>    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_u_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mask);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mask);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_mask);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_cmask = ((arrayobject *)__pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">216</span>:             self.mask = cmask</pre>
<pre class='cython code score-2 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(((PyObject *)__pyx_v_cmask), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 216, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;mask, 0);
    __pyx_v_self-&gt;mask = __pyx_t_6;
    __pyx_t_6.memview = NULL;
    __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">217</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">218</span>:         # Window is always a wavetable, defaults to Hann</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:         if win &gt; -1:</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((__pyx_v_win &gt; -1L) != 0);
  if (__pyx_t_3) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">220</span>:             self.win = wavetables._window(win, win_length)</pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_f_5pippi_10wavetables__window(__pyx_v_win, __pyx_v_win_length);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 220, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;win, 0);
    __pyx_v_self-&gt;win = __pyx_t_7;
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:         elif win_wt is not None:</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((((PyObject *) __pyx_v_win_wt.memview) != Py_None) != 0);
  if (__pyx_t_3) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:             self.win = win_wt</pre>
<pre class='cython code score-0 '>    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;win, 0);
    __PYX_INC_MEMVIEW(&amp;__pyx_v_win_wt, 0);
    __pyx_v_self-&gt;win = __pyx_v_win_wt;
</pre><pre class="cython line score-0">&#xA0;<span class="">223</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:             self.win = wavetables._window(wavetables.HANN, win_length)</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_7 = __pyx_f_5pippi_10wavetables__window(__pyx_v_5pippi_10wavetables_HANN, __pyx_v_win_length);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;win, 0);
    __pyx_v_self-&gt;win = __pyx_t_7;
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
  }
  __pyx_L5:;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:         self.win_length = len(self.win)</pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;win.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 225, __pyx_L1_error)</span>}
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_self-&gt;win); 
  __pyx_v_self-&gt;win_length = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">226</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">227</span>:         # Read lfo is always a wavetable, defaults to phasor</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:         if read_lfo &gt; -1:</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((__pyx_v_read_lfo &gt; -1L) != 0);
  if (__pyx_t_3) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:             self.read_lfo = wavetables._window(read_lfo, read_lfo_length)</pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_f_5pippi_10wavetables__window(__pyx_v_read_lfo, __pyx_v_read_lfo_length);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 229, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;read_lfo, 0);
    __pyx_v_self-&gt;read_lfo = __pyx_t_7;
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:         elif read_lfo_wt is not None:</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = (__pyx_v_read_lfo_wt != Py_None);
  __pyx_t_1 = (__pyx_t_3 != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>:             self.read_lfo = interpolation._linear(np.asarray(read_lfo_wt, dtype='d'), read_lfo_length)</pre>
<pre class='cython code score-27 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 231, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 231, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 231, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_read_lfo_wt);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_read_lfo_wt);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_read_lfo_wt);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 231, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_n_u_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 231, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 231, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_10, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 231, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_11 = __pyx_f_5pippi_13interpolation__linear(__pyx_t_7, __pyx_v_read_lfo_length);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 231, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;read_lfo, 0);
    __pyx_v_self-&gt;read_lfo = __pyx_t_11;
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">232</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:             self.read_lfo = wavetables._window(wavetables.PHASOR, read_lfo_length)</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_11 = __pyx_f_5pippi_10wavetables__window(__pyx_v_5pippi_10wavetables_PHASOR, __pyx_v_read_lfo_length);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 233, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;read_lfo, 0);
    __pyx_v_self-&gt;read_lfo = __pyx_t_11;
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
  }
  __pyx_L6:;
</pre><pre class="cython line score-0">&#xA0;<span class="">234</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:         self.read_lfo_speed = read_lfo_speed</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;read_lfo_speed = __pyx_v_read_lfo_speed;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:         self.read_lfo_length = read_lfo_length</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;read_lfo_length = __pyx_v_read_lfo_length;
</pre><pre class="cython line score-0">&#xA0;<span class="">237</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">238</span>:         # If speed_lfo &lt; 0 and speed_lfo_wt is None, then use fixed speed</pre>
<pre class="cython line score-0">&#xA0;<span class="">239</span>:         # No transposition is done if speed == 1</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:         if speed_lfo &gt; -1:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_speed_lfo &gt; -1L) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L7;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:             self.speed_lfo = wavetables._window(speed_lfo, speed_lfo_length)</pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_f_5pippi_10wavetables__window(__pyx_v_speed_lfo, __pyx_v_speed_lfo_length);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;speed_lfo, 0);
    __pyx_v_self-&gt;speed_lfo = __pyx_t_11;
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">242</span>:         elif speed_lfo_wt is not None:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((((PyObject *) __pyx_v_speed_lfo_wt.memview) != Py_None) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L7;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:             self.speed_lfo = speed_lfo_wt</pre>
<pre class='cython code score-0 '>    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;speed_lfo, 0);
    __PYX_INC_MEMVIEW(&amp;__pyx_v_speed_lfo_wt, 0);
    __pyx_v_self-&gt;speed_lfo = __pyx_v_speed_lfo_wt;
</pre><pre class="cython line score-0">&#xA0;<span class="">244</span>:         else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>:             self.speed_lfo = None</pre>
<pre class='cython code score-2 '>  /*else*/ {
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(Py_None, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;speed_lfo, 0);
    __pyx_v_self-&gt;speed_lfo = __pyx_t_11;
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
  }
  __pyx_L7:;
</pre><pre class="cython line score-0">&#xA0;<span class="">246</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>:         if self.speed_lfo is not None:</pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;speed_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 247, __pyx_L1_error)</span>}
  __pyx_t_1 = ((((PyObject *) __pyx_v_self-&gt;speed_lfo.memview) != Py_None) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">248</span>:             self.speed_lfo_length = len(self.speed_lfo)</pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;speed_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>}
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_self-&gt;speed_lfo); 
    __pyx_v_self-&gt;speed_lfo_length = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">249</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">250</span>:         if speed &lt;= 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_speed &lt;= 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">251</span>:             speed = MIN_SPEED</pre>
<pre class='cython code score-0 '>    __pyx_v_speed = 1e-06;
</pre><pre class="cython line score-0">&#xA0;<span class="">252</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>:         if minspeed &lt;= 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_minspeed &lt;= 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:             minspeed = MIN_SPEED</pre>
<pre class='cython code score-0 '>    __pyx_v_minspeed = 1e-06;
</pre><pre class="cython line score-0">&#xA0;<span class="">255</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>:         if maxspeed &lt;= 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_maxspeed &lt;= 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>:             maxspeed = MIN_SPEED</pre>
<pre class='cython code score-0 '>    __pyx_v_maxspeed = 1e-06;
</pre><pre class="cython line score-0">&#xA0;<span class="">258</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:         self.speed = speed</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;speed = __pyx_v_speed;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:         self.minspeed = minspeed</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;minspeed = __pyx_v_minspeed;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:         self.maxspeed = maxspeed</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;maxspeed = __pyx_v_maxspeed;
</pre><pre class="cython line score-0">&#xA0;<span class="">262</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">263</span>:         self.density = density</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;density = __pyx_v_density;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:         self.mindensity = mindensity</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;mindensity = __pyx_v_mindensity;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:         self.maxdensity = maxdensity</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;maxdensity = __pyx_v_maxdensity;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:         if density_lfo &gt; -1:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_density_lfo &gt; -1L) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L12;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">267</span>:             self.density_lfo = wavetables._window(density_lfo, density_lfo_length)</pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_f_5pippi_10wavetables__window(__pyx_v_density_lfo, __pyx_v_density_lfo_length);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;density_lfo, 0);
    __pyx_v_self-&gt;density_lfo = __pyx_t_11;
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:         elif density_lfo_wt is not None:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((((PyObject *) __pyx_v_density_lfo_wt.memview) != Py_None) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L12;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">269</span>:             self.density_lfo = density_lfo_wt</pre>
<pre class='cython code score-0 '>    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;density_lfo, 0);
    __PYX_INC_MEMVIEW(&amp;__pyx_v_density_lfo_wt, 0);
    __pyx_v_self-&gt;density_lfo = __pyx_v_density_lfo_wt;
</pre><pre class="cython line score-0">&#xA0;<span class="">270</span>:         else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:             self.density_lfo = None</pre>
<pre class='cython code score-2 '>  /*else*/ {
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(Py_None, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 271, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;density_lfo, 0);
    __pyx_v_self-&gt;density_lfo = __pyx_t_11;
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
  }
  __pyx_L12:;
</pre><pre class="cython line score-0">&#xA0;<span class="">272</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:         self.density_lfo_speed = density_lfo_speed</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;density_lfo_speed = __pyx_v_density_lfo_speed;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>:         if self.density_lfo is not None:</pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;density_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>}
  __pyx_t_1 = ((((PyObject *) __pyx_v_self-&gt;density_lfo.memview) != Py_None) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:             self.density_lfo_length = len(self.density_lfo)</pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;density_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 275, __pyx_L1_error)</span>}
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_self-&gt;density_lfo); 
    __pyx_v_self-&gt;density_lfo_length = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">276</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:         if grainlength_lfo &gt; -1:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_grainlength_lfo &gt; -1L) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L14;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:             self.grainlength_lfo = wavetables._window(grainlength_lfo, grainlength_lfo_length)</pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_f_5pippi_10wavetables__window(__pyx_v_grainlength_lfo, __pyx_v_grainlength_lfo_length);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;grainlength_lfo, 0);
    __pyx_v_self-&gt;grainlength_lfo = __pyx_t_11;
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:             self.grainlength = -1</pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;grainlength = -1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:         elif grainlength_lfo_wt is not None:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((((PyObject *) __pyx_v_grainlength_lfo_wt.memview) != Py_None) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L14;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">281</span>:             self.grainlength_lfo = grainlength_lfo_wt</pre>
<pre class='cython code score-0 '>    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;grainlength_lfo, 0);
    __PYX_INC_MEMVIEW(&amp;__pyx_v_grainlength_lfo_wt, 0);
    __pyx_v_self-&gt;grainlength_lfo = __pyx_v_grainlength_lfo_wt;
</pre><pre class="cython line score-0">&#xA0;<span class="">282</span>:         else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>:             self.grainlength_lfo = None</pre>
<pre class='cython code score-2 '>  /*else*/ {
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(Py_None, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 283, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;grainlength_lfo, 0);
    __pyx_v_self-&gt;grainlength_lfo = __pyx_t_11;
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
  }
  __pyx_L14:;
</pre><pre class="cython line score-0">&#xA0;<span class="">284</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:         self.grainlength = grainlength</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;grainlength = __pyx_v_grainlength;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:         self.minlength = minlength</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;minlength = __pyx_v_minlength;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">287</span>:         self.maxlength = maxlength</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;maxlength = __pyx_v_maxlength;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>:         self.grainlength_lfo_speed = grainlength_lfo_speed</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;grainlength_lfo_speed = __pyx_v_grainlength_lfo_speed;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>:         if self.grainlength_lfo is not None:</pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;grainlength_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 289, __pyx_L1_error)</span>}
  __pyx_t_1 = ((((PyObject *) __pyx_v_self-&gt;grainlength_lfo.memview) != Py_None) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>:             self.grainlength_lfo_length = len(self.grainlength_lfo)</pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;grainlength_lfo.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 290, __pyx_L1_error)</span>}
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_self-&gt;grainlength_lfo); 
    __pyx_v_self-&gt;grainlength_lfo_length = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">291</span>: </pre>
<pre class="cython line score-92" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:     cpdef SoundBuffer play(GrainCloud self, double length=10):</pre>
<pre class='cython code score-92 '>static PyObject *__pyx_pw_5pippi_6grains_10GrainCloud_3play(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static struct __pyx_obj_5pippi_11soundbuffer_SoundBuffer *__pyx_f_5pippi_6grains_10GrainCloud_play(struct __pyx_obj_5pippi_6grains_GrainCloud *__pyx_v_self, int __pyx_skip_dispatch, struct __pyx_opt_args_5pippi_6grains_10GrainCloud_play *__pyx_optional_args) {
  double __pyx_v_length = ((double)10.0);
  int __pyx_v_framelength;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_5pippi_11soundbuffer_SoundBuffer *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("play", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_length = __pyx_optional_args-&gt;length;
    }
  }
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_play);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_5pippi_6grains_10GrainCloud_3play)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_5) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
          PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_3};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
          PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_3};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        {
          __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5pippi_11soundbuffer_SoundBuffer))))) <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L1_error)</span>
      __pyx_r = ((struct __pyx_obj_5pippi_11soundbuffer_SoundBuffer *)__pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pippi.grains.GrainCloud.play", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5pippi_6grains_10GrainCloud_3play(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_5pippi_6grains_10GrainCloud_3play(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_length;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("play (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_length,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_length);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "play") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_length = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_length == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L3_error)</span>
    } else {
      __pyx_v_length = ((double)10.0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("play", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pippi.grains.GrainCloud.play", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5pippi_6grains_10GrainCloud_2play(((struct __pyx_obj_5pippi_6grains_GrainCloud *)__pyx_v_self), __pyx_v_length);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5pippi_6grains_10GrainCloud_2play(struct __pyx_obj_5pippi_6grains_GrainCloud *__pyx_v_self, double __pyx_v_length) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("play", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.length = __pyx_v_length;
  __pyx_t_1 = ((PyObject *)__pyx_vtabptr_5pippi_6grains_GrainCloud-&gt;play(__pyx_v_self, 1, &amp;__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pippi.grains.GrainCloud.play", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:         cdef int framelength = &lt;int&gt;(self.samplerate * length)</pre>
<pre class='cython code score-0 '>  __pyx_v_framelength = ((int)(__pyx_v_self-&gt;samplerate * __pyx_v_length));
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">294</span>:         cdef double[:,:] out = np.zeros((framelength, self.channels), dtype='d')</pre>
<pre class='cython code score-37 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_framelength);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;channels);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_4);
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_n_u_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:         out = _play(self, out, framelength, length)</pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_f_5pippi_6grains__play(__pyx_v_self, __pyx_v_out, __pyx_v_framelength, __pyx_v_length);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  __pyx_v_out = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:         return SoundBuffer(out, length=length, channels=self.channels, samplerate=self.samplerate)</pre>
<pre class='cython code score-40 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_length);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_length, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;channels);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_channels, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;samplerate);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_samplerate, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_5pippi_11soundbuffer_SoundBuffer), __pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = ((struct __pyx_obj_5pippi_11soundbuffer_SoundBuffer *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">297</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">299</span>: </pre>
</div></body></html>
